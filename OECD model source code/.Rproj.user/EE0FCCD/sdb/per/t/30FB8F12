{
    "collab_server" : "",
    "contents" : "library(PKSFC)\n\nsource(\"compare.R\")\n\ndetach(result)\n\n#Generating the calibration\nsource(\"FileGen.R\")\n\n#Loading up the model without calibration\nmodelLines<-readLines(\"modellStripped.sfc\")\n\n#Loading up the calibration\ncalibrationLines<-readLines(\"calibration.txt\")\n\n#Finding the calibration to be added\nindexCalib<-grep(\"CALIBRATION\",modelLines)\n\n#Adding the calibration into the model\ntotModel<-c(modelLines[1:(indexCalib-1)],calibrationLines,modelLines[(indexCalib+1):length(modelLines)])\n\n#Writing the complete model\nwriteLines(totModel,\"modelAuto.sfc\")\n\n#Loading the model\nclimate<-sfc.model(\"modelAuto.sfc\",modelName=\"climate\")\n\n#Adding some scenarios\nclimate<-sfc.addScenario(climate,list(c(\"alpha1\")),list(c(alpha1[t]*0.9)),c(2012),c(2040))\nclimate<-sfc.addScenario(climate,list(c(\"betag\")),list(c(betag[t]*1.1)),c(2012),c(2040))\nclimate<-sfc.addScenario(climate,list(c(\"grprd\")),list(c(0.01)),c(2012),c(2040))\nclimate<-sfc.addScenario(climate,list(c(\"grprd\")),list(c(-0.01)),c(2012),c(2040))\n\n# Simulate the model\ndata<-simulate(climate,tolValue = 1e-10, maxIter=100000)\n\n#Getting the results into a nicer format\nresult<-as.data.frame(data$baseline)\nresult$year<-as.numeric(rownames(result))\n\nconShock<-as.data.frame(data$scenario_1)\nconShock$year<-as.numeric(rownames(conShock))\n\nphaseShock<-as.data.frame(data$scenario_2)\nphaseShock$year<-as.numeric(rownames(phaseShock))\n\npricePosShock<-as.data.frame(data$scenario_3)\npricePosShock$year<-as.numeric(rownames(pricePosShock))\n\npriceNegShock<-as.data.frame(data$scenario_4)\npriceNegShock$year<-as.numeric(rownames(priceNegShock))\n\n#Creating a dataset with historical and simulated data\ndetach(Results)\ncnCal<-colnames(Results)\ncnRes<-colnames(result)\nblockAdd<-as.data.frame(matrix(NA,ncol=ncol(result),nrow=17))\ncolnames(blockAdd)<-cnRes\nfor(name in cnRes){\n  iCal<-grep(paste(\"^\",name,\"$\",sep=\"\"),cnCal,fixed=F)\n  if(length(iCal)>0){\n    blockAdd[name]<-Results[1:17,iCal]\n  }else{\n    blockAdd[name]<-result[2,name]\n  }\n}\nrownames(blockAdd)<-blockAdd$year\nresult<-rbind(blockAdd,result[2:30,])\nattach(result)\n\n#Plotting results - GDP and components\nnames<-c(\"Y\",\"C\",\"Ic\",\"Ig\",\"Id\",\"G\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"mln2012$\",xlab=\"\")\nabline(v=2011)\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=c(\"Output\",\"Consumption\",\"Investment\",\"Green energy investment\",\"Dirty energy investment\",\"Govt. Expenditure\"),cex=0.8, pt.cex = 1)\ndev.copy2eps(file=\"../figures/NominalValues.eps\")\ndev.off()\n\nnames<-c(\"kgA\",\"kdA\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"GW\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=c(\"Green energy capacity\",\"Dirty energy capacity\"))\nabline(v=2011)\ndev.copy2eps(file=\"../figures/CapacityStocks.eps\")\ndev.off()\n\nnames<-c(\"Pkd\",\"Pkg\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"2012$/GW\",xlab=\"\")\nlegend(\"topright\",lwd=2,bty='n',col=1:7,lty=1,legend=c(\"Price of dirty GW\",\"Price of green GW\"))\nabline(v=2011)\ndev.copy2eps(file=\"../figures/CapacityPrices.eps\")\ndev.off()\n\nnames<-c(\"eg\",\"ed\",\"e\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"TWh\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=c(\"Green energy\",\"Dirty energy\", \"Total\"))\nabline(v=2011)\ndev.copy2eps(file=\"../figures/EnergyProduction.eps\")\ndev.off()\n\nnames<-c(\"shareeg\",\"shareed\")\nmatplot(result$year,100*result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"%\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=c(\"Renewables\",\"Dirty\"))\nabline(v=2011)\ndev.copy2eps(file=\"../figures/EnergyShares.eps\")\ndev.off()\n\nnames<-c(\"gy\",\"gY\",\"gc\",\"gic\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"gid\",\"gig\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"ge\",\"ged\",\"geg\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"id\",\"ig\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nabline(v=2011)\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"grc\",\"grg\",\"grd\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nabline(v=2011)\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"ukg\",\"ukd\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"kgA\",\"kdA\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Pkd\",\"Pkg\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Pc\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Pe\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Lc\",\"Lg\",\"Ld\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"D\",\"L\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Fc\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"Fg\",\"Fd\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"eg\",\"ed\",\"e\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n\nnames<-c(\"shareeg\",\"shareed\")\nmatplot(result$year,result[names],type=\"l\",lty=1,lwd=2,col=1:7,ylab=\"\",xlab=\"\")\nlegend(\"topleft\",lwd=2,bty='n',col=1:7,lty=1,legend=names)\n",
    "created" : 1470215259879.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2779013685",
    "id" : "30FB8F12",
    "lastKnownWriteTime" : 1470215633,
    "last_content_update" : 1470215633316,
    "path" : "C:/Users/ku57637/Dropbox/Research/Seminars/AppliedSFC_R/OECD model source code/Model.R",
    "project_path" : "Model.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}